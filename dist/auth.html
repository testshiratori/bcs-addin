<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Auth Callback</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script>
    Office.initialize = function () {
      window.onload = function () {
        const params = new URLSearchParams(window.location.search);
        const code = params.get("code");

        if (code) {
          // 親に authorization_code を返す
          Office.context.ui.messageParent(code);
        } else {
          const error = params.get("error_description") || "コードが見つかりません";
          Office.context.ui.messageParent("error: " + error);
        }
      };
    };
  </script>
</head>
<body>
  <h2>認証コードを受信しました。処理中です…</h2>
</body>
</html>
